(function(win, doc){
  'use strict';
  
  var
    getRootPath = function(){
      var parts = win.location.pathname.split('/');
      parts.shift(); // remove first
      parts.pop(); // remove last
      parts.pop(); // yes, twice
      var path = parts.join('/');
      return '/' + path;
    },
    root_http = getRootPath(),
    browser_plugin = 'filebrowser_upload',
    plugin_dir = root_http + '/externs/ckeditor/plugins/',
    openshift = 'http://filebrowser4openshift-jwalker.rhcloud.com',
    browser = new FileBrowser({
      root_http: openshift + '/server-side/writable',
      server_http: openshift + '/server-side/filebrowser.php',
    })
  ;
  window.showUploadDialog = function(){
    browser.show();
  };

  tinymce.init({
    selector:'textarea',
    toolbar: "image filebrowser",
    plugins: "image imagetools filebrowser"
  });
  
  browser.setEditor(ckeditor);

})(window, document);

